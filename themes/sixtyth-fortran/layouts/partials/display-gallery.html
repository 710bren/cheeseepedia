<h2>Gallery</h2>
<div class="gallery">
  {{- $currentPageTitle := .Title -}} <!-- Get the base page title -->
  {{- $photos := partialCached "grab-all-photos.html" "key"}}
  {{- range sort $photos "Params.date" -}}
    {{- $matches := false -}} <!-- Flag to track if title matches in photos.pages array -->
    {{- range .Params.pages -}} <!-- Iterate through the pages array in photos parameter -->
      {{- if eq . $currentPageTitle -}} <!-- Check if the current page title matches -->
        {{- $matches = true -}}
      {{- end -}}
    {{- end -}}

    {{- if $matches -}} <!-- If a match is found, display the photo -->
      <div class="gallery-image-box">
          {{- partial "filename-to-photo.html" .Title -}}
      </div>
    {{- end -}}
  {{- end -}}
</div>
<hr>